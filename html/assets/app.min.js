function viewDialog(id,url,title="",width="50%",height="95%",css_class=""){if(self!=top)return window.parent.viewDialog(id,url,title,width,height,css_class),!1;$.ajax({url:url,crossDomain:!0,crossOrigin:!0,beforeSend:function(t){t.setRequestHeader("X-Requested-With","XMLHttpRequest")},success:function(popup_content){if(popup_content.status)"reload"==popup_content.status?window.open(popup_content.message,"_self"):toastNotify(popup_content.message,popup_content.status);else{var popup_id="popup-"+id;0==$("#"+popup_id).length&&($("#dialog").append('<div id="'+popup_id+'"></div>'),css_class="none"==css_class?"":""==css_class?"view-dialog":"view-dialog "+css_class,dialog=new ej.popups.Dialog({enableHtmlSanitizer:!1,cssClass:css_class,allowDragging:!0,enableResize:!0,isModal:!0,header:title,showCloseIcon:!0,closeOnEscape:!0,content:popup_content,animationSettings:{effect:"None"},width:width,height:height,zIndex:4e3,created:function(){for(var arr=document.getElementById(popup_id+"_dialog-content").getElementsByTagName("script"),n=0;n<arr.length;n++)"text/x-template"!=arr[n].type.toLowerCase()&&eval(arr[n].innerHTML)},beforeClose:function(){tinyMCE.editors[0]&&tinyMCE.editors[0].editorManager.remove(),$("#popup-"+id).remove()}}),dialog.appendTo("#"+popup_id),dialog.show())}}})}function formDialog(id,url,title="",width="60%",height="auto",css_class="dlg-no-header",button_name="Save"){if(self!=top)return window.parent.formDialog(id,url,title,width,height,css_class),!1;"undefined"!=typeof provision_title&&provision_title.length>0&&provision_title>""&&(title="Activate "+provision_title),$.ajax({url:url,crossDomain:!0,crossOrigin:!0,beforeSend:function(t){t.setRequestHeader("X-Requested-With","XMLHttpRequest")},success:function(popup_content){if(popup_content.status)"reload"==popup_content.status?window.open(popup_content.message,"_self"):toastNotify(popup_content.message,popup_content.status);else{var popup_id="popup-"+id;0==$("#"+popup_id).length&&($("#dialog").append('<div id="'+popup_id+'"></div>'),dialog=new ej.popups.Dialog({enableHtmlSanitizer:!1,cssClass:css_class,allowDragging:!0,enableResize:!0,isModal:!0,header:title,showCloseIcon:!0,closeOnEscape:!0,content:popup_content,animationSettings:{effect:"None"},width:width,height:height,zIndex:4e3,buttons:[{buttonModel:{isPrimary:!1,content:"Cancel"},click:function(){this.hide()}},{buttonModel:{isPrimary:!0,cssClass:"e-info dialogSubmitBtn mr-2",content:button_name},click:function(){$("#"+popup_id+"_dialog-content").find("form").submit()}}],created:function(){var popup_content=document.getElementById(popup_id+"_dialog-content");"Save"==button_name&&($(popup_content).find("#emailaddress").length>0||$(popup_content).find("#sendNewsletter").length>0)&&$("#"+popup_id+" .dialogSubmitBtn").text("Send");for(var arr=popup_content.getElementsByTagName("script"),n=0;n<arr.length;n++)"text/x-template"!=arr[n].type.toLowerCase()&&eval(arr[n].innerHTML)},beforeClose:function(){try{wizardTab&&wizardTab.destroy()}catch(t){}try{$(".stepbox").each(function(){$(this).remove()})}catch(t){}for(var t=tinyMCE.editors.length-1;t>-1;t--){var e=tinymce.editors[t].id;tinyMCE.execCommand("mceRemoveEditor",!0,e)}$("#popup-"+id).remove()}}),dialog.appendTo("#"+popup_id),dialog.show())}}})}function transactionDialog(id,url,title="",width="40%",height="auto"){if(self!=top)return window.parent.transactionDialog(id,url,title,width,height,css_class),!1;$.get(url,function(popup_content){if(popup_content.status)"reload"==popup_content.status?window.open(popup_content.message,"_self"):toastNotify(popup_content.message,popup_content.status);else{var popup_id="popup-"+id;0==$("#"+popup_id).length&&($("#dialog").append('<div id="'+popup_id+'"></div>'),dialog=new ej.popups.Dialog({enableHtmlSanitizer:!1,allowDragging:!0,enableResize:!0,isModal:!0,showCloseIcon:!0,closeOnEscape:!0,content:popup_content,animationSettings:{effect:"None"},width:width,height:height,buttons:[{buttonModel:{isPrimary:!1,content:"Cancel",iconCSS:"fa "},click:function(){this.hide()}},{buttonModel:{cssClass:"e-primary dialogSubmitBtn transactSubmitBtn",content:"Complete"},click:function(){$("#"+popup_id+"_dialog-content").find("form").submit()}}],created:function(){for(var arr=document.getElementById(popup_id+"_dialog-content").getElementsByTagName("script"),n=0;n<arr.length;n++)"text/x-template"!=arr[n].type.toLowerCase()&&eval(arr[n].innerHTML)},beforeClose:function(){tinyMCE.editors[0]&&tinyMCE.editors[0].editorManager.remove(),$("#popup-"+id).remove()}}),dialog.appendTo("#"+popup_id),dialog.show())}})}function gridAjax(t,e=null,o="get"){$.ajax({url:t,data:e,type:o,beforeSend:function(t){showSpinner()},success:function(t){hideSpinner(),console.log(t),processAjaxSuccess(t,!1)},error:function(t,e,o){hideSpinner(),processAjaxError(t,e,o)}})}function gridAjaxConfirm(t,e,o=null,i="get"){confirm(e)&&$.ajax({url:t,data:o,type:i,beforeSend:function(t){showSpinner()},success:function(t){hideSpinner(),processAjaxSuccess(t,!1)},error:function(t,e,o){hideSpinner(),processAjaxError(t,e,o)}})}function iframeFormSubmit(t,e){var o=$("#"+t).contents().find("#"+e),i=new FormData(o[0]);$("input[type=file]").each(function(){if($(this).val()>""){var t=$(this)[0].files.length;if(t>1)for(var e=0;e<t;e++)i.append($(this)[0].name+"[]",$(this)[0].files[e]);else i.append($(this)[0].name,$(this)[0].files[0])}}),$.ajax({method:"post",url:o.attr("action"),data:i,contentType:!1,processData:!1,beforeSend:function(t){try{showSpinner(),$(".dialogSubmitBtn").each(function(t){$(this).prop("disabled",!0)})}catch(t){}},success:function(t){try{hideSpinner()}catch(t){}processAjaxSuccess(t)},error:function(t,e,o){try{hideSpinner()}catch(t){}processAjaxError(t,e,o)}})}function formSubmit(t,e=!1){$("#"+t+" :disabled").each(function(t){$(this).removeAttr("disabled")});var o=$("#"+t),i=new FormData(o[0]);if($("input[type=file]").each(function(){if($(this).val()>""){var t=$(this)[0].files.length;if(t>1)for(var e=0;e<t;e++)i.append($(this)[0].name+"[]",$(this)[0].files[e]);else i.append($(this)[0].name,$(this)[0].files[0])}}),$("#signature").length>0){var n=$("#signature").attr("name"),a=signaturePad.toDataURL();i.append(n,a)}$.ajax({method:"post",url:o.attr("action"),data:i,contentType:!1,processData:!1,beforeSend:function(t){$("#processing_div").length>0&&$("#processing_div").show();try{showSpinner(),$(".dialogSubmitBtn").each(function(t){$(this).prop("disabled",!0)})}catch(t){}},success:function(t){$("#processing_div").length>0&&$("#processing_div").hide();try{hideSpinner()}catch(t){}0!=e&&e(t),processAjaxSuccess(t)},error:function(t,e,o){$("#processing_div").length>0&&$("#processing_div").hide();try{hideSpinner()}catch(t){}processAjaxError(t,e,o)}})}function ajaxSend(t,e,o="Updated",i=""){$.ajax({type:"post",url:t,data:e,success:function(t){toastNotify(o,"success")},error:function(t,e,o){""==i&&(i=e),toastNotify(i,"error")}})}function toastNotify(t="",e="info",o=!0,i=!1,n=5e3){"email_success"==e&&(e="success"),"email_error"==e&&(e="warning");var a=new ej.notifications.Toast({content:t,position:{X:"Left",Y:"Bottom"},showCloseButton:!0,timeOut:n,target:document.body});"success"==e?(a.cssClass="e-toast-success",a.icon="e-success toast-icons",a.title="Success"):"error"==e?(a.cssClass="e-toast-error",a.icon="e-error toast-icons",a.title="Error"):"warning"==e?(a.cssClass="e-toast-warning",a.icon="e-warning toast-icons",a.title="Warning"):"info"==e&&(a.cssClass="e-toast-info",a.icon="e-info toast-icons",a.title="Info"),i&&(a.icon=i),a.appendTo("#toast"),a.show()}function getGlobalProperties(t){var e=[],o=window;for(var i in o)0==i.indexOf(t)&&e.push(i);return e}function getMenuList(){var t=[],e=window;for(var o in e)-1!==o.indexOf("treeObj")&&t.push(o);return t}function msgPopup(t,e){$("body").append('<div id="msg-pop"></div>'),ej.base.enableRipple(!0);new ej.popups.Dialog({content:e,cssClass:"msg-popup",target:document.getElementById("container"),width:"30%",header:t,showCloseIcon:!0,isModal:!0,animationSettings:{effect:"Zoom"},closeOnEscape:!0,beforeClose:function(){$("#msg-pop").remove()}},"#msg-pop")}function processAjaxSuccess(t,e=!0){try{var o=getGlobalProperties("grid_");$(o).each(function(t,e){"grid_height"!=e&&"grid_default"!=e&&"grid_module_id"!=e&&"grid_config_id"!=e&&window[e].refresh()})}catch(t){}t.reload_grid_views&&reload_grid_views();try{var i=getMenuList();$(i).each(function(t,e){window[e].refresh()})}catch(t){}if($(".dialogSubmitBtn").each(function(t){$(this).prop("disabled",!1)}),t.check_grid_active&&($("#grid_default"+t.check_grid_active).length>0||$("#grid_ajax"+t.check_grid_active).length>0))try{dialog.hide()}catch(t){}if(t.status){if(t.provision_id)try{dialog.hide(),viewDialog("provison",t.provision_url,"Provision","70%")}catch(t){}if(t.print){try{printPDF(t.print),dialog.hide()}catch(t){}return!1}if("error"!=t.status&&"warning"!=t.status&&"Record Deleted."!=t.message&&"Duplicated"!=t.message&&1==e)try{dialog.hide()}catch(t){}if("msgPopup"==t.status)msgPopup(t.title,t.content);else if("viewDialog"==t.status){t.message>""&&toastNotify(t.message,"success");var n="Feedback";t.title>""&&(n=t.title),viewDialog("viewDialog",t.url,n,"80%","50%","")}else"querybuilder"==t.status?(t.message>""&&toastNotify(t.message,"success"),formDialog("querybuilder",t.url,"Query Builder","60%")):"formDialog"==t.status?(t.message>""&&toastNotify(t.message,"success"),formDialog("formDialog",t.url,"Feedback","50%","50%","","Submit")):"transactionDialog"==t.status?transactionDialog("edittrx",t.message,"Edit Transaction","80%","100%"):"reload"==t.status?window.open(t.message,"_self"):"success"==t.status?(toastNotify(t.message,"success"),1==t.refresh_instant&&location.reload()):"emailerror"==t.status?toastNotify(t.message,"error"):"error"==t.status?toastNotify(t.message,"error"):"refresh_instant"==t.status?location.reload():toastNotify(t.message,t.status);t.reload&&setTimeout(function(){window.open(t.reload,"_self")},1e3),t.new_tab&&setTimeout(function(){window.open(t.new_tab,"_blank")},1e3),t.refresh&&setTimeout(function(){location.reload()},1e3)}else{try{dialog.hide()}catch(t){}-1!=t.indexOf("err")||-1!=t.indexOf("error")||-1!=t.indexOf("Error")?toastNotify(t,"error"):toastNotify(t)}if(t.close_dialog)try{dialog.hide()}catch(t){}}function processAjaxError(t,e,o){try{var i=getGlobalProperties("grid_");$(i).each(function(t,e){"grid_default"!=e&&"grid_module_id"!=e&&"grid_config_id"!=e&&window[e].refresh()})}catch(t){}$(".dialogSubmitBtn").each(function(t){$(this).prop("disabled",!1)}),toastNotify(e,"error")}function closeActivePopup(){try{$(".e-popup-open:last").parent().remove()}catch(t){}}function ucwords(t){return(t+"").replace(/^([a-z])|\s+([a-z])/g,function(t){return t.toUpperCase()})}function statement_email(t){formDialog("statement"+t,"/email_form/statement_email/"+t,"Send Statement","70%")}function full_statement_email(t){formDialog("statement"+t,"/email_form/full_statement_email/"+t,"Send Statement","70%")}function supplier_statement_email(t){formDialog("statement"+t,"/email_form/supplier_statement_email/"+t,"Send Statement","70%")}function supplier_full_statement_email(t){formDialog("statement"+t,"/email_form/supplier_full_statement_email/"+t,"Send Statement","70%")}function doc_email(t){formDialog("docemail"+t,"/email_form/documents/"+t,"Send Document","70%")}function usddoc_email(t){formDialog("docemail"+t,"/email_form/usd_documents/"+t,"Send Document","70%")}function enableDialogSubmit(){$(".dialogSubmitBtn").each(function(t){$(this).prop("disabled",!1)})}function disableDialogSubmit(){$(".dialogSubmitBtn").each(function(t){$(this).prop("disabled",!0)})}function printPDF(t){var e=this._printIframe;this._printIframe||(e=this._printIframe=document.createElement("iframe"),document.body.appendChild(e),e.style.display="none",e.onload=function(){setTimeout(function(){e.focus(),e.contentWindow.print()},1)}),e.src=t}function makeid(t){for(var e="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=o.length,n=0;n<t;n++)e+=o.charAt(Math.floor(Math.random()*i));return e}$(document).ready(function(){document.getElementById("container")}),$(document).on("click",'a[data-target="view_modal"]',function(t){var e=makeid(5),o=$(this).attr("data-close-dialog");if(void 0!==o&&!1!==o)try{$(".msg-popup:last").parent().remove(),closeActivePopup()}catch(t){}t.preventDefault(),console.log(window.location.pathname),console.log($(this)[0].pathname),window.location.pathname==$(this)[0].pathname?window.location.href=$(this).attr("href"):viewDialog(e,$(this).attr("href"),"","70%")}),$(document).on("click",'a[data-target="view_modal_large"]',function(t){var e=makeid(5),o=$(this).attr("data-close-dialog");if(void 0!==o&&!1!==o)try{$(".msg-popup:last").parent().remove(),closeActivePopup()}catch(t){}t.preventDefault(),console.log(window.location.pathname),console.log($(this)[0].pathname),window.location.pathname==$(this)[0].pathname?window.location.href=$(this).attr("href"):viewDialog(e,$(this).attr("href"),"","95%")}),$(document).on("click",'a[data-target="view_modal_full"]',function(t){var e=makeid(5),o=$(this).attr("data-close-dialog");if(console.log(o),void 0!==o&&!1!==o)try{$(".msg-popup:last").parent().remove(),closeActivePopup()}catch(t){}t.preventDefault(),console.log(window.location.pathname),console.log($(this)[0].pathname),window.location.pathname==$(this)[0].pathname?window.location.href=$(this).attr("href"):viewDialog(e,$(this).attr("href"),"","100%","100%")}),$(document).on("click",'a[data-target="ajax"]',function(t){makeid(5);t.preventDefault(),gridAjax($(this).attr("href"))}),$(document).on("click",'a[data-target="javascript"]',function(t){var e=$(this).attr("js-target");window[e]()}),$(document).on("click",'a[data-target="form_modal"]',function(t){var e=makeid(5);t.preventDefault(),formDialog(e,$(this).attr("href"),"","70%")}),$(document).on("click",'a[data-target="form_modal_full"]',function(t){var e=makeid(5);t.preventDefault(),formDialog(e,$(this).attr("href"),"","100%","100%")});